(self.webpackChunk=self.webpackChunk||[]).push([[23],{757:(t,e,n)=>{n.d(e,{interactionAreasService:()=>j});var i=n(2245),o=n.n(i),a=n(81),s=n(8146),c=n(5504),l=n(1575),r=n(9242),d=n(7912);const u=t=>{let{text:e,onClick:n,theme:i="",loadingDelay:o=0}=t;return(0,s.M0)({tag:"button",attr:{class:`vp-theme-button theme-${i}`},onClick:n,children:[{tag:"div",attr:{class:"vp-loading-bar"},style:{"animation-duration":`${o}ms`}},{tag:"div",attr:{class:"content"},children:e}]})},h=(t,e)=>t.id||t.type||`id_${e}`,m=(t,e,n,i,o)=>{let{playerOptions:l,videojsOptions:d}=t;const u=(0,r.X)(d),m=l&&l.colors?l.colors.accent:u.accent,v=(0,c.U2)(d,"interactionDisplay.theme.template",a.iG.PULSING);return(0,s.M0)({tag:"div",attr:{class:`${a.YL}-item theme-${v}`,"data-id":h(e,n)},style:{left:`${e.left}%`,top:`${e.top}%`,width:`${e.width}%`,height:`${e.height}%`,transitionDuration:`${i}ms`},event:{name:"click",callback:o},children:[{tag:"div",attr:{class:`${a.YL}-area-marker`},children:[{tag:"div",attr:{class:`${a.YL}-marker-shadow`},style:{[v===a.iG.SHADOWED?"backgroundColor":"borderColor"]:m}},{tag:"div",attr:{class:`${a.YL}-marker-main`},style:{borderColor:m}}]}]})},v=(t,e)=>t/(100/+e),p=(t,e)=>{const n=y(t);n?n.replaceWith(e):t.el().appendChild(e)},g=(t,e,n)=>t.querySelector(`[data-id=${h(e,n)}]`),f=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.ZT;localStorage.setItem(a.mq,JSON.parse(t)),e()},y=t=>t.el().querySelector(`.${a.Ub}`),b=t=>{const e=y(t);e&&e.parentNode.removeChild(e)};var $=n(3483),k=n(5262),w=n(5672);const j=(t,e,n)=>{let i=!1,r=null,j=null,C=l.ZT;const L=()=>{const t=T();return!(!t||void 0===t.syncOffsetTime)&&t.syncOffsetTime};function E(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=T();return t||e&&e.enable}function x(){j&&t.videojs.removeRemoteTextTrack(j);const e=E(),n=T();if(!e||i)return null;if(Array.isArray(n.template))O(n.template),A();else{const e=n.vttUrl||a.jC[n.template];e&&(j=(0,k.Bt)(t.videojs,e),function(e){if(!e)return;let n=null;e.addEventListener("cuechange",(()=>{const i=e.activeCues&&e.activeCues[0];if(i){const t=Math.max(Math.floor(1e3*(i.endTime-i.startTime)),a.qn),e=JSON.parse(i.text);O(e,n,t),!n&&A(),n=e}else b(t.videojs),n=null}))}(j))}}function T(){const{cldSrc:t}=r;return t&&t.getInteractionAreas()}function M(){b(t.videojs),x(),t.play()}function S(){if(E())if(e=n.interactionDisplay,(0,c.U2)(e,"layout.enable",!0)&&"true"!==localStorage.getItem(a.mq)){let e=null;const i=(0,c.U2)(n,"interactionDisplay.layout.showAgain",!1);t.pause(),function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;const o=`checkbox_${Math.round(1e4*Math.random())}`,c=(0,s.M0)({tag:"div",attr:{class:`${a.Ub} ${a.YL}-layout-message ${n?"":"clickable"}`},onClick:n?null:()=>f(i,e),children:[{tag:"img",attr:{class:`${a.YL}-layout-icon`,src:a.jQ}},{tag:"h3",attr:{class:`${a.YL}-layout-message-title`},children:"Tap on dots to zoom for a product."},u({text:"Got it",theme:"transparent-white",loadingDelay:n?0:a.EJ,onClick:n?()=>f(i,e):null}),n&&{tag:"div",attr:{class:`${a.YL}-layout-message-do-not-show`},children:[{tag:"input",attr:{type:"checkbox",class:`${a.YL}-layout-message-checkbox`,id:o},event:{name:"input",callback:t=>{i=t.target.checked}}},{tag:"label",attr:{class:`${a.YL}-layout-message-checkbox-title`,for:o},children:"Don×³t show it again"}]}].filter((t=>t))});p(t,c)}(t.videojs,(()=>{clearTimeout(e),M()}),i),i||(e=setTimeout(M,a.EJ))}else M();var e}function D(e){let{event:n,item:c,index:l}=e;const d=T();d.onClick&&d.onClick({item:c,index:l,event:n,zoom:(e,n)=>{!function(e,n,c){const l=t.currentTime(),d=L(),{cldSrc:u}=r,h=u.getInitOptions(),m=n||{transformation:h.transformation},g=!e&&((t,e)=>{const{videoHeight:n,videoWidth:i}=t,o=v(i,e.left),a=v(n,e.top),s=v(i,e.width),c=v(n,e.height),l=i/n,r=s/c,d=Math.round(r>1||l>1?c*r:s),u=Math.round(d/l),h=Math.round(o-(d-s)/2),m=Math.round(a-(u-c)/2);return{width:d,height:u,x:Math.min(Math.max(h,0),i-d),y:Math.min(Math.max(m,0),n-u),crop:"crop"}})(t.videoElement,c),f=g?o().obj.merge({transformation:g},m):m,y=u.isRawUrl?r.src:{publicId:u.publicId()};t.source(g?{publicId:u.publicId()}:e,f).play(),d&&t.currentTime(l),i=!0,function(){const e=(0,s.az)("div",{class:"go-back-button"});e.addEventListener("click",(()=>{C()}),!1);const n=(0,s.az)("div",{class:a.Ub},e);p(t.videojs,n)}(),C=()=>{if(i){i=!1;const e=t.currentTime(),n=t.duration();t.source(y,h).play(),d&&e<n&&t.currentTime(e),x()}}}(e,n,c)}})}function O(i,o){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l={playerOptions:e,videojsOptions:n};if(o)((t,e,n,i,o,a)=>{const c=y(t);(0,d.Ed)(n,((t,n)=>{const l=g(c,t,n),r=h(t),u=(0,d.G)(i,(t=>h(t)===r));u&&l?(0,s.p2)(l,{left:`${t.left}%`,top:`${t.top}%`,width:`${t.width}%`,height:`${t.height}%`,transitionDuration:`${o}ms`}):u||l||c.appendChild(m(e,t,n,o,(e=>{a({event:e,item:t,index:n})})))})),(0,d.Ed)(i,((t,e)=>{const i=g(c,t,e),o=h(t),a=!(0,d.G)(n,(t=>h(t)===o));i&&a&&i.parentNode.removeChild(i)}))})(t.videojs,l,i,o,c,D);else{const e=i.map(((t,e)=>m(l,t,e,c,(n=>{D({event:n,item:t,index:e})}))));p(t.videojs,(0,s.az)("div",{class:a.Ub},e))}}function A(){E()&&((t,e)=>{const n=y(t);if(!n)return;const{videoHeight:i,videoWidth:o}=e,a=o/i,s=a*e.clientHeight;n.style.width=`${e.clientWidth<s?"100%":s}px`,n.style.height=e.clientWidth<s?e.clientWidth/a+"px":"100%"})(t.videojs,t.videoElement)}!function(){if(r=r||t.videojs.currentSource(),E()){t.videojs.el().classList.add("interaction-areas"),t.videojs.one(w.Z.PLAY,(()=>{"object"==typeof t.videojs.ima?t.on("adsready",(()=>{t.videojs.ima.addEventListener(window.google.ima.AdEvent.Type.ALL_ADS_COMPLETED,S)})):S()}));const e=(0,$.P)(A,100);t.videojs.on(w.Z.FULL_SCREEN_CHANGE,(()=>{setTimeout(e,100)}));const n=(0,s.Oo)(window,"resize",A,!1);t.videojs.on(w.Z.DISPOSE,n)}t.videojs.on(w.Z.ENDED,(()=>{C()})),t.videojs.on(w.Z.ERROR,(()=>{t.pause()}))}()}},3483:(t,e,n)=>{function i(t,e){let n=window.performance.now();return function(){const i=window.performance.now();i-n>=e&&(t(...arguments),n=i)}}n.d(e,{P:()=>i})}}]);
//# sourceMappingURL=interaction-areas.js.map