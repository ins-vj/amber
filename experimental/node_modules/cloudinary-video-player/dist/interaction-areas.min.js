"use strict";(self.webpackChunkcloudinary_video_player=self.webpackChunkcloudinary_video_player||[]).push([[23],{757:(t,e,n)=>{n.d(e,{interactionAreasService:()=>C});var i=n(2245),o=n.n(i),a=n(81),s=n(8146),c=n(5504),r=n(1575),l=n(9242),d=n(7912);const u=t=>{let{text:e,onClick:n,theme:i="",loadingDelay:o=0}=t;return(0,s.M0)({tag:"button",attr:{class:`vp-theme-button theme-${i}`},onClick:n,children:[{tag:"div",attr:{class:"vp-loading-bar"},style:{"animation-duration":`${o}ms`}},{tag:"div",attr:{class:"content"},children:e}]})},h="transparent-white",m=(t,e)=>t.id||t.type||`id_${e}`,v=(t,e,n,i,o)=>{let{playerOptions:r,videojsOptions:d}=t;const u=(0,l.X)(d),h=r&&r.colors?r.colors.accent:u.accent,v=(0,c.U2)(d,"interactionDisplay.theme.template",a.iG.PULSING);return(0,s.M0)({tag:"div",attr:{class:`${a.YL}-item theme-${v}`,"data-id":m(e,n)},style:{left:`${e.left}%`,top:`${e.top}%`,width:`${e.width}%`,height:`${e.height}%`,transitionDuration:`${i}ms`},event:{name:"click",callback:o},children:[{tag:"div",attr:{class:`${a.YL}-area-marker`},children:[{tag:"div",attr:{class:`${a.YL}-marker-shadow`},style:{[v===a.iG.SHADOWED?"backgroundColor":"borderColor"]:h}},{tag:"div",attr:{class:`${a.YL}-marker-main`},style:{borderColor:h}}]}]})},p=(t,e)=>t/(100/+e),g=(t,e)=>{const n=b(t);n?n.replaceWith(e):t.el().appendChild(e)},f=(t,e,n)=>t.querySelector(`[data-id=${m(e,n)}]`),y=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ZT;localStorage.setItem(a.mq,JSON.parse(t)),e()},b=t=>t.el().querySelector(`.${a.Ub}`),$=t=>{const e=b(t);e&&e.parentNode.removeChild(e)};var k=n(3483),w=n(5262),j=n(5672);const C=(t,e,n)=>{let i=!1,l=null,C=null,L=r.ZT;const E=()=>{return t=n.interactionDisplay,(0,c.U2)(t,"layout.enable",!0)&&"true"!==localStorage.getItem(a.mq);var t},x=()=>{const t=S();return!(!t||void 0===t.syncOffsetTime)&&t.syncOffsetTime};function T(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=S();return t||e&&e.enable}function M(){C&&t.videojs.removeRemoteTextTrack(C);const e=T(),n=S();if(!e||i)return null;if(Array.isArray(n.template))Y(n.template),I();else{const e=n.vttUrl||a.jC[n.template];e&&(C=(0,w.Bt)(t.videojs,e),function(e){if(!e)return;let n=null;e.addEventListener("cuechange",(()=>{const i=e.activeCues&&e.activeCues[0];if(i){const t=Math.max(Math.floor(1e3*(i.endTime-i.startTime)),a.qn),e=JSON.parse(i.text);Y(e,n,t),!n&&I(),n=e}else $(t.videojs),n=null}))}(C))}}function S(){const{cldSrc:t}=l;return t&&t.getInteractionAreas()}function D(){$(t.videojs),M(),t.play()}function O(){if(T())if(E()){let e=null;const i=(0,c.U2)(n,"interactionDisplay.layout.showAgain",!1);t.pause(),function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;const o=`checkbox_${Math.round(1e4*Math.random())}`,c=(0,s.M0)({tag:"div",attr:{class:`${a.Ub} ${a.YL}-layout-message ${n?"":"clickable"}`},onClick:n?null:()=>y(i,e),children:[{tag:"img",attr:{class:`${a.YL}-layout-icon`,src:a.jQ}},{tag:"h3",attr:{class:`${a.YL}-layout-message-title`},children:"Tap on dots to zoom for a product."},u({text:"Got it",theme:h,loadingDelay:n?0:a.EJ,onClick:n?()=>y(i,e):null}),n&&{tag:"div",attr:{class:`${a.YL}-layout-message-do-not-show`},children:[{tag:"input",attr:{type:"checkbox",class:`${a.YL}-layout-message-checkbox`,id:o},event:{name:"input",callback:t=>{i=t.target.checked}}},{tag:"label",attr:{class:`${a.YL}-layout-message-checkbox-title`,for:o},children:"Don×³t show it again"}]}].filter((t=>t))});g(t,c)}(t.videojs,(()=>{clearTimeout(e),D()}),i),i||(e=setTimeout(D,a.EJ))}else D()}function A(e,n,c){const r=t.currentTime(),d=x(),{cldSrc:u}=l,h=u.getInitOptions(),m=n||{transformation:h.transformation},v=!e&&((t,e)=>{const{videoHeight:n,videoWidth:i}=t,o=p(i,e.left),a=p(n,e.top),s=p(i,e.width),c=p(n,e.height),r=i/n,l=s/c,d=Math.round(l>1||r>1?c*l:s),u=Math.round(d/r),h=Math.round(o-(d-s)/2),m=Math.round(a-(u-c)/2);return{width:d,height:u,x:Math.min(Math.max(h,0),i-d),y:Math.min(Math.max(m,0),n-u),crop:"crop"}})(t.videoElement,c),f=v?o().obj.merge({transformation:v},m):m,y=u.isRawUrl?l.src:{publicId:u.publicId()};t.source(v?{publicId:u.publicId()}:e,f).play(),d&&t.currentTime(r),i=!0,function(){const e=(0,s.az)("div",{class:"go-back-button"});e.addEventListener("click",(()=>{L()}),!1);const n=(0,s.az)("div",{class:a.Ub},e);g(t.videojs,n)}(),L=()=>{if(i){i=!1;const e=t.currentTime(),n=t.duration();t.source(y,h).play(),d&&e<n&&t.currentTime(e),M()}}}function U(t){let{event:e,item:n,index:i}=t;const o=S();o.onClick&&o.onClick({item:n,index:i,event:e,zoom:(t,e)=>{A(t,e,n)}})}function Y(i,o){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={playerOptions:e,videojsOptions:n};if(o)((t,e,n,i,o,a)=>{const c=b(t);(0,d.Ed)(n,((t,n)=>{const r=f(c,t,n),l=m(t),u=(0,d.G)(i,(t=>m(t)===l));u&&r?(0,s.p2)(r,{left:`${t.left}%`,top:`${t.top}%`,width:`${t.width}%`,height:`${t.height}%`,transitionDuration:`${o}ms`}):u||r||c.appendChild(v(e,t,n,o,(e=>{a({event:e,item:t,index:n})})))})),(0,d.Ed)(i,((t,e)=>{const i=f(c,t,e),o=m(t),a=!(0,d.G)(n,(t=>m(t)===o));i&&a&&i.parentNode.removeChild(i)}))})(t.videojs,r,i,o,c,U);else{const e=i.map(((t,e)=>v(r,t,e,c,(n=>{U({event:n,item:t,index:e})}))));g(t.videojs,(0,s.az)("div",{class:a.Ub},e))}}function I(){T()&&((t,e)=>{const n=b(t);if(!n)return;const{videoHeight:i,videoWidth:o}=e,a=o/i,s=a*e.clientHeight;n.style.width=`${e.clientWidth<s?"100%":s}px`,n.style.height=e.clientWidth<s?e.clientWidth/a+"px":"100%"})(t.videojs,t.videoElement)}!function(){if(l=l||t.videojs.currentSource(),T()){t.videojs.el().classList.add("interaction-areas"),t.videojs.one(j.Z.PLAY,(()=>{"object"==typeof t.videojs.ima?t.on("adsready",(()=>{t.videojs.ima.addEventListener(window.google.ima.AdEvent.Type.ALL_ADS_COMPLETED,O)})):O()}));const e=(0,k.P)(I,100);t.videojs.on(j.Z.FULL_SCREEN_CHANGE,(()=>{setTimeout(e,100)}));const n=(0,s.Oo)(window,"resize",I,!1);t.videojs.on(j.Z.DISPOSE,n)}t.videojs.on(j.Z.ENDED,(()=>{L()})),t.videojs.on(j.Z.ERROR,(()=>{t.pause()}))}()}},3483:(t,e,n)=>{function i(t,e){let n=window.performance.now();return function(){const i=window.performance.now();i-n>=e&&(t(...arguments),n=i)}}n.d(e,{P:()=>i})}}]);
//# sourceMappingURL=interaction-areas.min.js.map